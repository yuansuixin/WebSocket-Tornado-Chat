# 基于tornado的WebSocket聊天室


> 开发环境

- pycharm
- 使用到的库在requirement.txt文件中







底层是由魔法字符串实现

## WebSocket

- 概述
    - Http ，socket实现，短链接，短时间断开，请求响应
    - WebSocket，socket实现，双工通道，让他断开才断开，请求响应，推送，服务端可以主动地想客服端推送消息，本质就是Socket创建链接，不断开。

- socket入手
    - 服务端（socket服务端）
      1.服务端开启socket，监听IP和端口
      3,允许连接
      5，&&服务端接收到特殊值【特殊值加密sha1，migic_string='285EAFA5-E914-47DA-95CA-C5AB0DC85B11'】,根据migic string进行sha1加密，migic string是一个固定的值，
      6，&&加密后的值发送给客户端
    - 客户端（浏览器）
      2.客户端发起连接请求（IP和端口）
      4，&&客户端生成一个xxxx，【特殊值加密sha1，migic_string='285EAFA5-E914-47DA-95CA-C5AB0DC85B11'】，向服务端发送这段特殊值xxxx
      7，&&客户端接收到加密的值，跟自己加密的值作对比，如果相同则遵循websocket规则，（保证协议相同，就可以通信了，）

    - 创建好链接之后，**收发数据**
        - 客户端和服务端传输数据时，需要对数据进行【封包】和【解包】操作，客户端的JavaScript类库已经封装了【封包】和【解包】过程，但socket服务端需要手动实现。

[Web Socket详细解析](https://yuansuixin.github.io/2018/04/10/websocket/ "Web Socket详细解析")

[解包和封包原理](https://yuansuixin.github.io/2018/04/09/websocket-data/ "解包和封包原理")





## 知识点补充
- 位运算，右移动  >>
    - 10010001
    - 右移4:00001001  前面补0
    - 左移4：100100010000  后面补0
- 异或运算，向异取1
    - 都是1： 0
    - 0,1： 1
    - 0,0:  0
- 与运算
    - 一个字节八位，如果要后四位的值那么就设计一个值和原值进行与运算结果还是后四位
    - 0 0 0 0 0 0 0 0 要取后四位的值，只需要和00001111进行与运算，前面的四位为0000忽略掉，即可得到后四位还是0000














